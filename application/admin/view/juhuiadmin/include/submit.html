<script>    var form, laydate, $, layedit, upload;    layui.use(['upload', 'layedit', 'form', 'layedit', 'laydate'], function() {        $ = layui.jquery;        form = layui.form;        laydate = layui.laydate;        upload = layui.upload;        layedit = layui.layedit;        form.render();        //日期        laydate.render({            elem: '#date_hash'            });        upload.render({        elem: '#Mobile-icon' //绑定元素        ,url: '/cdnUploads' //上传接口        ,accept:"file"        ,exts: 'jpg|png'        , method: "post"        // , auto: false  //auto 参数必须设置为false        ,done: function(res) {            //上传完毕回调            console.log(res);            $('.tips-1').hide();            $('#Mobile-icon').children('.title-tips2').show();            var html;            html = '<img src="'+res.file+'" width="100">';            $('#Mobile-icon').children('.Micon').html(html);        }    });        upload.render({            elem: '#PC-icon' //绑定元素            ,url: '/cdnUploads' //上传接口            ,accept:"file"            ,exts: 'jpg|png'            , method: "post"            // , auto: false  //auto 参数必须设置为false            ,done: function(res){                //上传完毕回调                $('.tips-2').hide();                $('#PC-icon').children('.title-tips2').show();                var html;                html = '<img src="'+res.file+'" width="100">';                $('#PC-icon').children('.Picon').html(html);            }        });        /*editor*/        layedit.set({            uploadImage: {                url: '/uploadImage' //接口url                //,type: '' //默认post            }        });        var pcontent = layedit.build('pc', {            height: 180 //设置编辑器高度            ,width: 300        });        var mcontent = layedit.build('mobile', {            height: 180 //设置编辑器高度            ,width: 300        });        /*editor-End*/        /****************************************表单提交*/        //addmenu        form.on('submit(tomenu)', function(data) {            $.fn.repost( data.field.u, data.field);        });        form.on('submit(addnews)', function(data) {            data.field.Pc_icon = $('.Picon').children('img').attr('src');            data.field.Mobile_icon = $('.Micon').children('img').attr('src');            data.field.Pcontent = layedit.getContent(pcontent);            data.field.Mcontent = layedit.getContent(mcontent);            $.fn.repost( data.field.u, data.field);        });    });    //外部function    layui.jquery.fn.repost = function(url, data) {        layui.jquery.post(url, data, function(res) {            console.log(res);            if ( res.code === 200 )  {                layer.msg('<span><i class="layui-icon layui-icon-ok" style="    color: white; background: #6cd965;     margin-right: 13px;border-radius: 10px;"></i>'+res.msg+'</span>', {                    time : 1000,                    maxWidth: 850,                }, function() {                    layer.close(layer.index);                    window.parent.location.reload();                });            } else {                layer.msg('<span><i class="layui-icon layui-icon-close" style="    color: white; background: red;     margin-right: 13px;border-radius: 10px;"></i>'+res.msg+'</span>', {                    time : 2000,                    // time: 2, //2s后自动关闭                });            }        }, 'json');    };</script>